---
title: "Midterm Paper"
author: "econ4ever"
date: "`r Sys.Date()`"
output: output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r init, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 

#all libraries go here
library(ezids)
library(ggplot2)
library(tidyverse)

# knitr::opts_chunk$set(warning = F, results = "markup", message = F)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
# options(scipen=9, digits = 3) 
# ‘scipen’: integer. A penalty to be applied when deciding to print numeric values in fixed or exponential notation.  Positive values bias towards fixed and negative towards scientific notation: fixed notation will be preferred unless it is more than ‘scipen’ digits wider.
# use scipen=999 to prevent scientific notation at all times
```

## Introduction

We have data over a 26 month period i.e. from January 2020 to the end of February 2022.


```{r}

crimedata <- read.csv("data/dc-crimes-search-results.csv")
#removing redundant variables
crimedata1 <- crimedata[, c(2,6,9,10,11,12,23,26,27)]

#changing the blank spaces to NAs
crimedata1[crimedata1 == "" | crimedata1 == " "] <- NA

#converting REPORT_DAT from character to date format 
crimedata1$REPORT_DAT <- as.Date(crimedata1$REPORT_DAT, "%m/%d/%Y")

```

Is there a correlation between time of day and type of crime committed? 


```{r, results='markup'}

crimedata1 %>% ggplot(aes(y = OFFENSE, fill = SHIFT)) +
  geom_histogram(stat = "count", binwidth = 1) + 
  theme(plot.title = element_text(hjust = 0.5),
        panel.background = element_blank(),
        panel.border = element_rect(fill = NA),
        panel.grid.major.y = element_line(color = "light gray"),
      #  panel.grid.minor.y = element_line(color = "black"),
        panel.grid.major.x = element_blank()) +
    #  axis.text.x = element_text(angle = 90)) +
  
  labs(y = "Type of Offense", x = "Frequency", title = "Time of Day Certain Crimes Are Most Likely To Occur", 
      fill = "Time of Day")
```

```{r}
chisq.test(crimedata1$SHIFT, crimedata1$OFFENSE)

```


Type of crime most likely to occur in each ward? Can time of day be added here

```{r, results='markup'}

crimedata1 %>% ggplot(aes(x = WARD, fill = OFFENSE)) +
  geom_histogram() +
  theme(plot.title = element_text(hjust = 0.5),
        panel.background = element_blank(),
        panel.border = element_rect(fill = NA),
        panel.grid.major.y = element_line(color = "light gray"),
      #  panel.grid.minor.y = element_line(color = "black"),
        panel.grid.major.x = element_blank()) +
  scale_x_continuous(breaks = c(seq(1,8, by=1),9999)) +
 labs(x = "Ward", fill = "Type of Offense", y = "Frequency", )


```


Is there a correlation between property crime and violent crime? (we could create a graph which has both types of crimes on the axes and the colors of the dots represent the 8 wards)

```{r}

propcrimes <- subset(crimedata1[crimedata1$offensegroup == "property",])
vicrimes <- subset(crimedata1[crimedata1$offensegroup == "violent",])


```